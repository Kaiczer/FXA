# Useful triggers for the annexation codebase
is_valid_annexation_state = {
	is_owned_by = ROOT
	is_claim_or_core_of_ROOT = no
	hidden_trigger = {
		NOT = { has_state_flag = retain_state_@PREV }
		NOT = { has_variable = retain_state_@THIS }
		NOT = { has_state_flag = occupied_by_@ROOT }
		NOT = { has_variable = occupied_by_@THIS }
	}
}

can_select_annexation_mission = {
	hidden_trigger = { NOT = { has_country_flag = open_annexation_event } }
}

is_clear_other_claims = {
	NOT = {
		is_important_state = yes
		any_other_country = {
			is_ally_with = ROOT
			PREV = { is_claim_or_core_of_PREV = yes }
		}
	}
	OR = {
		NOT = { has_variable = ambition_area_@ROOT }
		AND = {
			ROOT = { tag = JAP }
			OR = {
				region = 194 #Malay Peninsula
				region = 91 #Arafura & Banda Seas
				region = 93 #Java & Flores Seas
				region = 158 #Sunda Islands
				region = 159 #Borneo
				region = 167 #New Guinea
				region = 192 #Sumatra
			}
		}
		ROOT = { is_ai = no }
	}
}

has_no_african_interests = {
	OR = {
		has_socialist_government = yes
		NOT = {
			tag = POR
		}
	}
}

ROOT_can_grant_land = {
	exists = yes
	NOT = { tag = ROOT }
	OR = {
		is_ally_with = ROOT
		AND = {
			both_socialist_or_both_not_socialist = yes
			at_war_with_or_justifying_wargoal_against_ROOT = no
		}
	}
}

puppet_may_be_annexed = {
	# Soviet Union
}

stt_puppet_may_be_annexed = {
	# Soviet Union
}

stt_no_conflict_game_rules = {
	if = {
		limit = { has_game_rule = { rule = state_transfer_tool_options option = MULTIPLAYER } }
		OR = {
			is_owned_by = ROOT
			owner = {
				stt_puppet_may_be_annexed = no
				is_subject_of = ROOT
			}
		}
	}
	else_if = {
		limit = { has_game_rule = { rule = state_transfer_tool_options option = MP_NO_SUBJECT } }
		is_owned_by = ROOT
	}
}

remove_cores_of_tag_if_non_existent = {
	OR = {
		is_american_tag = yes
		is_italian_tag = yes
		is_indian_tag = yes
		has_country_flag = is_chinese_tag
		original_tag = KML 
		#add new entries here as needed
	}
}
